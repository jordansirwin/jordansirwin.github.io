<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>JordanIrwin.net</title>

    <meta property="og:site_name"
          content="JordanIrwin.net" >
  
    <meta property="og:title"
          content="C# Interface vs. Class" >
    <meta property="og:type"
          content="article" >
    <meta property="og:description"
          content="The original version of this post is lost to a deprecated blog of mine. I was able to retrieve an archive from archive.org. You may find the archive of this post here." >
    <meta property="og:url"
          content="http://www.jordanirwin.net/2014/09/01/csharp-interface-vs-class/" >

    <meta property="article:published_time"
          content="2014-09-01T00:00:00-07:00" >
    <meta property="article:author"
          content="http://www.jordanirwin.net/about/" >
  

    <meta name="viewport" 
          content="width=device-width, initial-scale=1.0">
    <meta name="description" 
          content="Thoughts, rants, tips, tricks, stories, truths, and lies.">
    <meta name="keywords" 
          content="geek,roleplay,technology,programming,c#,video game,gaming" />

    <link href="http://www.jordanirwin.net/feed.xml" 
          rel="alternate" 
          type="application/atom+xml">
    <link href="/content/pygments/syntax.css" 
          rel="stylesheet">
    <link href="/content/self/self.min.css" 
          rel="stylesheet">
    <link rel="icon" 
          type="image/x-icon" 
          href="/favicon.ico?v=1" />

    <script 
      src="//code.jquery.com/jquery-2.1.1.min.js"
      type="text/javascript"></script>
    <script 
      src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js">
      type="text/javascript"></script>
            
  </head>

  <body>

    <div class="container">

      <div class="row">
        <div class="responsive-col">
          <p class="text-center">Thoughts, rants, tips, tricks, stories, truths, and lies.</p>
        </div>
      </div>
      
      <div class="row">
        <div class="content responsive-col">
          <div class="post well">
  <small>September 1, 2014</small>
  <h3><a href="/2014/09/01/csharp-interface-vs-class/">C# Interface vs. Class</a></h3>

  <p><em>The original version of this post is lost to a deprecated blog of mine. I was able to retrieve an archive from <a href="https://archive.org">archive.org</a>. <a href="https://web.archive.org/web/20101121204212/http://www.jordansirwin.com/archives/2009/03/c-interface-vs-class">You may find the archive of this post here.</a></em></p>

<p>Originally posted: March 11, 2009</p>

<hr />

<p>Recently, a colleague asked me what the difference between an interface and a class was. Here’s what was really being asked:</p>

<blockquote>

  <p>“Why would you use an interface instead of an abstract or inherited class?”</p>

</blockquote>

<p>After reassuring them that it wasn’t a stupid question (I’m willing to bet most developers have pondered this very question- I did), I went into a long explanation full of lousy examples and bad analogies. I think I was able to make a good case for using interfaces, but just to be sure I’ve decided to add more noise to the Internet.</p>

<p>If you’re not familiar with the basics of an interface, I recommend a quick detour to <a href="http://msdn.microsoft.com/en-us/library/ms173156.aspx">MSDN</a> for an overview. Maybe if you’re lucky, you’ll completely understand and won’t continue reading my attempt to explain them.</p>

<p>In a nutshell- an interface is a set of rules. It regulates its consumer by enforcing that certain methods, delegates, and/or events must be defined. Clear as mud, right? Let’s try an example, followed by a bad car analogy if you’re not so lucky.</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span>    <span class="c1">// Define an interface to &quot;do something&quot;</span>
    <span class="k">interface</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Foo will be our &quot;service&quot;, it wants to &quot;do interesting things&quot;</span>
    <span class="k">class</span> <span class="nc">Foo</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomethingInteresting</span><span class="p">(</span>
        <span class="n">IFooCanUseMeNow</span> <span class="n">classThatDoesSometing</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// use the interface to &quot;do something&quot;</span>
        <span class="c1">// it doesn&#39;t matter what the class really is,</span>
        <span class="c1">// it only matters that it implemented the</span>
        <span class="c1">// interface</span>
        <span class="n">classThatDoesSometing</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Bar implements the interface, so therefore</span>
    <span class="c1">// Foo can &quot;do something&quot; with it</span>
    <span class="k">class</span> <span class="nc">Bar</span> <span class="p">:</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="c1">// I have no idea what a bar can do, but do it anyways</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Bartender implements the interface, so therefore</span>
    <span class="c1">// Foo can &quot;do something&quot; with it</span>
    <span class="k">class</span> <span class="nc">Bartender</span> <span class="p">:</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="c1">// like serve a beer</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Barber implements the interface, so therefore</span>
    <span class="c1">// Foo can &quot;do something&quot; with it</span>
    <span class="k">class</span> <span class="nc">Barber</span> <span class="p">:</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="c1">// maybe cut some hair</span>
      <span class="p">}</span>
    <span class="p">}</span></code></pre></figure>

<p>In case the comments weren’t enough, let me explain this example in depth. The class, Foo, desires only one thing: “to do interesting things”. Its entire purpose in life is to perform “interesting things”, regardless of what they are, who they’re from, what side-effects they have, how to do them, etc… Foo simply doesn’t care about the details. This is accomplished via the interface IFooCanUseMeNow.</p>

<p>IFooCanUseMeNow has one rule: “in order to use me, you must implement a method called DoSomething that accepts no parameters and returns no values.” Pretty straight forward (I hope). Foo has a method called DoSomethingInteresting which accepts any object that implements IFooCanUseMeNow. Since all objects that implement IFooCanUseMeNow must (because of the rules) have a method called DoSomething, this means that Foo can invoke this method.</p>

<p>I’ve also declared several classes which implement IFooCanUseMeNow: Bar, Bartender, and Barber. Each one of these classes likely perform different tasks (come on, use your imagination!). The beauty of interfaces is that Foo doesn’t have to know anything about these classes to perform their actions. Because they follow the “rules” set by IFooCanUseMeNow, Foo can interact with them. Foo can now cut hair, serve beers, and… uhmm… sit around being board (hah, bad joke).</p>

<p>In case you’re completely lost, here’s a brief example of how these classes could interact:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span>    <span class="k">class</span> <span class="nc">ExampleOfUse_WithInterface</span>
    <span class="p">{</span>
      <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="c1">// Create our interesting classes that do stuff</span>
        <span class="n">Bar</span> <span class="n">bar</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Bar</span><span class="p">();</span>
        <span class="n">Bartender</span> <span class="n">bartender</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Bartender</span><span class="p">();</span>
        <span class="n">Barber</span> <span class="n">barber</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Barber</span><span class="p">();</span>

        <span class="c1">// Create our Foo</span>
        <span class="n">Foo</span> <span class="n">foo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Foo</span><span class="p">();</span>

        <span class="c1">// let Foo do interesting things</span>
        <span class="n">foo</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">bar</span><span class="p">);</span> <span class="c1">// whatever a bar does</span>
        <span class="n">foo</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">bartender</span><span class="p">);</span> <span class="c1">// serve beers</span>
        <span class="n">foo</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">barber</span><span class="p">);</span> <span class="c1">// cut hair</span>
      <span class="p">}</span>
    <span class="p">}</span></code></pre></figure>

<p>Now the big question: “Why didn’t you just do this by inheriting a class?”. Here’s the exact same situation, but using an abstract class instead of an interface:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span>    <span class="k">class</span> <span class="nc">ExampleOfUse_WithClass</span>
    <span class="p">{</span>
      <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="c1">// Create our interesting classes that do stuff</span>
        <span class="n">Bar</span> <span class="n">bar</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Bar</span><span class="p">();</span>
        <span class="n">Bartender</span> <span class="n">bartender</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Bartender</span><span class="p">();</span>
        <span class="n">Barber</span> <span class="n">barber</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Barber</span><span class="p">();</span>

        <span class="c1">// Create our Foo</span>
        <span class="n">Foo</span> <span class="n">foo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Foo</span><span class="p">();</span>

        <span class="c1">// let Foo do interesting things</span>
        <span class="n">foo</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">bar</span><span class="p">);</span> <span class="c1">// whatever a bar does</span>
        <span class="n">foo</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">bartender</span><span class="p">);</span> <span class="c1">// serve beers</span>
        <span class="n">foo</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">(</span><span class="n">barber</span><span class="p">);</span> <span class="c1">// cut hair</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">abstract</span> <span class="k">class</span> <span class="nc">FooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span>
      <span class="p">{</span>
        <span class="c1">// abstract class does nothing</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Foo</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">(</span>
        <span class="n">FooCanUseMeNow</span> <span class="n">classThatDoesSometing</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// use the class to &quot;do something&quot;</span>
        <span class="c1">// it doesn&#39;t matter what the class really is,</span>
        <span class="c1">// it only matters that it inherited the</span>
        <span class="c1">// abstract class defined</span>
        <span class="n">classThatDoesSometing</span><span class="p">.</span><span class="n">DoSomething</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Bar</span> <span class="p">:</span> <span class="n">FooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">override</span> <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Bartender</span> <span class="p">:</span> <span class="n">FooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">override</span> <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Barber</span> <span class="p">:</span> <span class="n">FooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">override</span> <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span>  <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span></code></pre></figure>

<p>As you can see, the code is very similar. The class version has a few more details (abstract, virtual, override), but it’s mostly the same code. The Main method that performs all of the work is actually exactly the same. So what’s the problem with using a class instead of an interface?</p>

<p>In such a simple example as this, the lines between a class and interface are a little blurry- they both work, with little reason to choose one over the other. But imagine a slightly more complicated example, where each of our “interesting classes” inherit from a base class:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span>    <span class="k">class</span> <span class="nc">Bar</span> <span class="p">:</span> <span class="n">CounterTop</span><span class="p">,</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Bartender</span> <span class="p">:</span> <span class="n">Person</span><span class="p">,</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Barber</span> <span class="p">:</span> <span class="n">Person</span><span class="p">,</span> <span class="n">IFooCanUseMeNow</span>
    <span class="p">{</span>
      <span class="k">public</span> <span class="k">void</span> <span class="nf">DoSomething</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">abstract</span> <span class="k">class</span> <span class="nc">CounterTop</span>
    <span class="p">{</span>
      <span class="c1">// base for all types of counter tops</span>
    <span class="p">}</span>

    <span class="k">abstract</span> <span class="k">class</span> <span class="nc">Person</span> 
    <span class="p">{</span>
      <span class="c1">// base for all people</span>
    <span class="p">}</span></code></pre></figure>

<p>In this example, it should be more apparent why using a class is not a good approach. Remember, C# allows as many interfaces as needed to be implemented but only allows one class to be inherited. With this more complex example, each of the “interesting classes” already inherit their base class, so they wouldn’t be able to inherit the FooCanUseMeNow class. Of course, you could have the low level abstract classes inherit FooCanUseMeNow, but that’s more or less hacking out a solution (just because Bartender and Barber can DoSomething, it doesn’t mean that some other Person can as well).</p>

<p>If you have understood everything thus far, then your imagination should be going wild with thoughts about past projects and examples of when you could have used interfaces. This example is just the tip of the iceberg. When fully understood, entire frameworks can be developed around interfaces- making them extensible and fluid. Nearly every problem can be solved with an interface, so I challenge you to try them out on your next one. I’m not suggesting that you go crazy here- I’m just suggesting that you find a way to use at least one interface to try it out. I think you’ll be satisfied with the outcome.</p>

<p>I hope the noise wasn’t too loud.</p>

<p>P.S. No car analogy comes to mind, so you’re getting off easy this time!</p>

</div>
        </div>
      </div>

      <div class="row">
        <div class="responsive-col">
          <ul class="nav navbar-nav nav-justified" role="navigation">
            
            <li>
                <a href="/" title="">Latest</a>
            </li>
            
            <li>
                <a href="/archives/" title="">Everything</a>
            </li>
            
            <li>
                <a href="/about/" title="">About</a>
            </li>
            
            <li>
                <a href="/feed.xml" title="">Feed</a>
            </li>
            
          </ul>
        </div>
      </div>
    </div>

  </body>


  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-52729827-1', 'auto');
    ga('send', 'pageview');
  </script>

</html>
